# Data analysis #

## Ovedispersed case ##

## Underdispersed case ##

### Cotton bolls greenhouse experiment ###

The data set in this section come from a greenhouse experiment with
cotton plants (Gossypium hirsutum) obtained under a completely
randomized design with five replicates. The experiment was aimed to
assess the effects of five defoliation levels (0%, 25%, 50%,75% and
100%) on the observed number of bolls produced by plants at five growth
stages: vegetative, flower-bud, blossom, fig and cotton boll. The
experimental unity was a vase with two plants. The number of cotton
bolls was recorded at the each culture cycle. This data was analysed by
@bonat2016b, with extended Poisson-Tweedie model and @zeviani2014 with
Gamma-Count model. In this section the results of articles are
reproduced and compared jointly others alternatives for analysis
(COM-Poisson model and Generalized-Poisson model).

This code below shows how to get the data and how it is structured in
R. The data set contains 125 records and 4 variables, described below:

* `defol` A numeric factor with 5 levels that represents the
    (artifitial) levels of defoliation (percent in leaf area removed
    with scissors) applied for all leaves of the plants.

* `phenol` A categorical ordered factor with 5 levels that represents
    the (phenological) growth stages of the cotton plants in which the
    levels of defoliation was applied.

* `rept` Integer variable that indexes each experimenal unit in each
    treatment cell.

* `bolls` The number of bolls produced (count variable) evaluated at
    harvest of cotton.

```{r}

## Read the data via package book
devtools::load_all()  ## Remove this
data(cotton, package = "rmcd")

## ## or read the data via url address
## url <- "http://cursos.leg.ufpr.br/rmcd/data/cotton.csv"
## cotton <- read.table(url, header = TRUE, sep = ";")

str(cotton)

```

Figure \@ref(fig:cotton) shows the number of cotton bolls recorded for
each combination of defoliation level and growth stage.

```{r cotton, echo=FALSE, fig.height=3, fig.width=7, fig.cap="Number of bolls produced for each artificial defoliation level and each growth stage."}

xyplot(bolls ~ defol | phenol,
       data = cotton,
       type = c("g", "p", "smooth"),
       jitter.x = TRUE,
       layout = c(NA, 1),
       xlab = "Artificial defoliation level",
       ylab = "Number of bolls produced")

```

## Equidispersed case ##

## Zero-Inflated case ##
